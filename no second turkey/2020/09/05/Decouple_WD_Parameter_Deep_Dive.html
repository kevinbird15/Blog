<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Decouple_WD Parameter Deep Dive | Impartial Derivative</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Decouple_WD Parameter Deep Dive" />
<meta name="author" content="Kevin Bird" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A deep dive into decouple_wd along with the code used to explore the concepts that come along with it" />
<meta property="og:description" content="A deep dive into decouple_wd along with the code used to explore the concepts that come along with it" />
<link rel="canonical" href="https://impartialderivative.com/no%20second%20turkey/2020/09/05/Decouple_WD_Parameter_Deep_Dive.html" />
<meta property="og:url" content="https://impartialderivative.com/no%20second%20turkey/2020/09/05/Decouple_WD_Parameter_Deep_Dive.html" />
<meta property="og:site_name" content="Impartial Derivative" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-09-05T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Kevin Bird"},"description":"A deep dive into decouple_wd along with the code used to explore the concepts that come along with it","mainEntityOfPage":{"@type":"WebPage","@id":"https://impartialderivative.com/no%20second%20turkey/2020/09/05/Decouple_WD_Parameter_Deep_Dive.html"},"@type":"BlogPosting","url":"https://impartialderivative.com/no%20second%20turkey/2020/09/05/Decouple_WD_Parameter_Deep_Dive.html","headline":"Decouple_WD Parameter Deep Dive","dateModified":"2020-09-05T00:00:00-05:00","datePublished":"2020-09-05T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://impartialderivative.com/feed.xml" title="Impartial Derivative" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-142115742-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Impartial Derivative</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Decouple_WD Parameter Deep Dive</h1><p class="page-description">A deep dive into decouple_wd along with the code used to explore the concepts that come along with it</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-09-05T00:00:00-05:00" itemprop="datePublished">
        Sep 5, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Kevin Bird</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      12 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#no second turkey">no second turkey</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/kevinbird15/Blog/tree/master/_notebooks/2020-09-05-Decouple_WD_Parameter_Deep_Dive.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/kevinbird15/Blog/master?filepath=_notebooks%2F2020-09-05-Decouple_WD_Parameter_Deep_Dive.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/kevinbird15/Blog/blob/master/_notebooks/2020-09-05-Decouple_WD_Parameter_Deep_Dive.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#Summary">Summary </a></li>
<li class="toc-entry toc-h3"><a href="#Deep-Dive">Deep Dive </a>
<ul>
<li class="toc-entry toc-h5"><a href="#Look-at-SGD-definition">Look at SGD definition </a></li>
<li class="toc-entry toc-h5"><a href="#weight_decay">weight_decay </a></li>
<li class="toc-entry toc-h5"><a href="#L2_reg">L2_reg </a></li>
<li class="toc-entry toc-h5"><a href="#Exploring-single-param">Exploring single param </a></li>
<li class="toc-entry toc-h5"><a href="#Weight_Decay-param-viewing">Weight_Decay param viewing </a></li>
<li class="toc-entry toc-h5"><a href="#Further-Reading">Further Reading </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-09-05-Decouple_WD_Parameter_Deep_Dive.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Summary">
<a class="anchor" href="#Summary" aria-hidden="true"><span class="octicon octicon-link"></span></a>Summary<a class="anchor-link" href="#Summary"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you don't plan to use weight decay (wd=0), you can safely ignore this parameter.</p>
<p>If you do plan to use weight decay, but don't have any idea whether to decouple weight decay or not, use the default of True.  It works the same as l2_reg on sgd and doesn't have</p>
<p>I don't currently know when you would want to use l2_reg vs weight decay unless trying to recreate historical results.</p>
<ul>
<li><a href="#weight_decay">If wd == 0: don't worry about decouple_wd</a></li>
<li><a href="#Look-at-SGD-definition">If decouple_wd is True, weight_decay is used, otherwise, l2_reg is used</a></li>
<li><a href="#Weight_Decay-param-viewing">weight_decay updates the value of params, l2_reg updates the param's gradients</a></li>
<li><a href="#weight_decay">weight_decay is directly tied to learning rate, l2_reg is not</a></li>
<li><a href="#Further-Reading">Further Reading</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Deep-Dive">
<a class="anchor" href="#Deep-Dive" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deep Dive<a class="anchor-link" href="#Deep-Dive"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the first blog post in my <a href="http://impartialderivative.com/no%20second%20turkey/2020/09/04/The-No-Second-Turkey-Learning-Concept.html">No Second Turkey</a> series.  <del>The concept that will be explored today is hyperparameters for SGD. Let's just dive right in:</del></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initially, my plan was to explore hyperparameters for SGD, but during the first hyperparameter that I looked at, I was derailed.  In this case, I felt like the exploration for this one parameter was interesting enough to have its own post.  We will explore more parameters and hyperparameters in the future, but for now, I am going to publish a deep dive on just <code>decouple_wd</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SGD</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;function fastai.optimizer.SGD(params, lr, mom=0.0, wd=0.0, decouple_wd=True)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I am going to dig into <code>decouple_wd</code>.  It looks like it defaults to True, but what is that actually changing?  First, let's look at the sgd code:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Look-at-SGD-definition">
<a class="anchor" href="#Look-at-SGD-definition" aria-hidden="true"><span class="octicon octicon-link"></span></a>Look at SGD definition<a class="anchor-link" href="#Look-at-SGD-definition"> </a>
</h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>SGD<span class="o">??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/images/copied_from_nb/../images/sgd_ss.png" alt="sgd_ss"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Answers lead to more questions.  It looks like decouple_wd determines if <code>weight_decay</code> or <code>l2_reg</code> should be added to the callback list.  My initial hunch is that these are two different forms of weight decay, but let's dig into each of them and see how they both work.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">weight_decay</span><span class="p">]</span> <span class="k">if</span> <span class="n">decouple_wd</span> <span class="k">else</span> <span class="p">[</span><span class="n">l2_reg</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>weight_decay<span class="o">??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">weight_decay</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">wd</span><span class="p">,</span> <span class="n">do_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="s2">"Weight decay as decaying `p` with `lr*wd`"</span>
    <span class="k">if</span> <span class="n">do_wd</span> <span class="ow">and</span> <span class="n">wd</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mul_</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">lr</span><span class="o">*</span><span class="n">wd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>l2_reg<span class="o">??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">l2_reg</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">wd</span><span class="p">,</span> <span class="n">do_wd</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="s2">"L2 regularization as adding `wd*p` to `p.grad`"</span>
    <span class="k">if</span> <span class="n">do_wd</span> <span class="ow">and</span> <span class="n">wd</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">wd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looking at the arguments each of these take in, it looks like they take in the exact same information.  So it is really saying do I want to do thing 1 with these variables, or do I want to do thing 2?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, I'm going to discect weight decay:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="weight_decay">
<a class="anchor" href="#weight_decay" aria-hidden="true"><span class="octicon octicon-link"></span></a>weight_decay<a class="anchor-link" href="#weight_decay"> </a>
</h5>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Part 1: <code>if do_wd and wd!=0:</code> This first part is already super important for our problem.  Since we have wd set to 0 by default, neither of these functions will do anything in the beginning.  That kind of answers my initial question of whether decouple_wd should be True or False, but let's finish exploring this branch while we are going down it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Part 2: <code>p.data.mul_(1 - lr*wd)</code> This is a nice clean line of code, but what does it actually mean/do?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>p</code> represents our <strong>params</strong> (went and verified in <a href="https://github.com/fastai/fastai/blob/master/fastai/optimizer.py#L82">optimizer code</a>).</p>
<p>This is a Tensor and I can tell that because of how <code>p.data</code> is used. That is usually a giveaway that the parameter is having its gradients calculated.  (You'll get a big error if you try to work with p directly instead of p.data)</p>
<p><code>mul_</code> is saying multiply something and store it back into p.data.<br>
<a href="https://pytorch.org/docs/stable/generated/torch.mul.html">I'm going to look at up for sure mostly because I want to see what type of multiplication is used.</a>.  The underscore runs the same function, but in pytorch, that is shorthand that says to store the results back into the tensor (similar to inplace=True in pandas if you are more familiar with that library).</p>
<p><code>1 - lr*wd</code> So when wd = 0, this would just multiple the params by 1 so there would be no affect which is also probably why it is skipped in that case.  Let's think about what happens in the alternative case though.  In the case where wd = 0.1 and lr = 1, this constant would be 0.9 so it would take every weight and cut it down.  So in practice, what does this do for us?  Our model can still tell the model to step back in the same direction.  I may have to think about this a bit more to understand why we would want to use weight decay.  For now, I am going to move on to l2_reg.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="L2_reg">
<a class="anchor" href="#L2_reg" aria-hidden="true"><span class="octicon octicon-link"></span></a>L2_reg<a class="anchor-link" href="#L2_reg"> </a>
</h5>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>L2_reg also checks if do_wd and wd!=0 similar to how weight decay works.  This is a bypass valve that says don't waste your calculations if wd is 0 or if you decide that you don't want any weight decay.</p>
<p><code>p.grad.data</code> is a lot different than p.data from weight_decay.  p.grad.data is actually looking at the gradient that was calculated.</p>
<p><code>add_</code> is then used to add a number into the gradients.</p>
<p><code>(p.data, alpha=wd)</code></p>
<p>I'm going to analyze this third part slightly out of order.  First I want to know what <code>alpha=wd</code> means:<br>
Torch's add function has an argument called alpha.  Alpha is a scalar that will be multiplied with the first argument.  In our case, <code>p.data</code>.</p>
<p>Our model weights get multiplied by a scalar value and that value is added to the gradient.  Let's try to figure out what this is trying to accomplish.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>weight_decay</code> dampens down the model's params directly <code>1-lr*wd</code> amount.  My initial thoughts with this is that I don't like that <code>lr</code> is involved in this process.  I'm not sure if that is an important piece that I'm not understanding, but it is something that I would rather not have involved in my weight_decay parameter.</p>
<p><code>l2_reg</code> adds a small value associated with the weights directly to the gradient.  This isn't intuitive to me.  I'm curious why adding a value that is scaled with a small value <code>wd</code> would be helpful for our model.  If anything, it seems like it would just end up adding a small amount of noise.  This one doesn't use the learning rate which I like.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since I don't feel like I currently have a good understanding of either weight_decay or l2_reg, I'm going to go do some searching and see if I can find some intuition around these two concepts.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I'm going to pull in the tst_param function which allows using a specific value and giving a specific gradient for the tensor.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Exploring-single-param">
<a class="anchor" href="#Exploring-single-param" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exploring single param<a class="anchor-link" href="#Exploring-single-param"> </a>
</h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#shamelessly stolen from fastai docs: https://docs.fast.ai/optimizer#sgd_step</span>
<span class="k">def</span> <span class="nf">tst_param</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">grad</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="s2">"Create a tensor with `val` and a gradient of `grad` for testing"</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="n">val</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    <span class="n">res</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="n">val</span><span class="o">/</span><span class="mi">10</span> <span class="k">if</span> <span class="n">grad</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">grad</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">tst_param</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">p_before</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">pg_before</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">weight_decay</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">p_after</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">pg_after</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Before and After p: '</span><span class="p">,</span> <span class="n">p_before</span><span class="p">,</span> <span class="s1">'-&gt;'</span><span class="p">,</span> <span class="n">p_after</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Before and After pg: '</span><span class="p">,</span> <span class="n">pg_before</span><span class="p">,</span> <span class="s1">'-&gt;'</span><span class="p">,</span> <span class="n">pg_after</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Before and After p:  tensor([1.]) -&gt; tensor([0.9000])
Before and After pg:  tensor([0.2000]) -&gt; tensor([0.2000])
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I was going to cycle through some numbers, but instead I'm going to cycle through a bunch and plot the output of p and p.grad</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learning_rate_l</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">weight_decay_l</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learning_rate_grid</span><span class="p">,</span> <span class="n">weight_decay_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">learning_rate_l</span><span class="p">,</span> <span class="n">weight_decay_l</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learning_rate_grid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.001, 0.01 , 0.1  , 1.   ],
       [0.001, 0.01 , 0.1  , 1.   ],
       [0.001, 0.01 , 0.1  , 1.   ],
       [0.001, 0.01 , 0.1  , 1.   ]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weight_decay_grid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.001, 0.001, 0.001, 0.001],
       [0.01 , 0.01 , 0.01 , 0.01 ],
       [0.1  , 0.1  , 0.1  , 0.1  ],
       [1.   , 1.   , 1.   , 1.   ]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">lr_list</span><span class="p">,</span><span class="n">wd_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">learning_rate_grid</span><span class="p">,</span> <span class="n">weight_decay_grid</span><span class="p">):</span>
    <span class="p">;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pg_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">lr</span><span class="p">,</span><span class="n">wd</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lr_list</span><span class="p">,</span> <span class="n">wd_list</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">tst_param</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">weight_decay</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">wd</span><span class="p">)</span>
    <span class="n">p_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">pg_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"lr:"</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span><span class="s2">"wd:"</span><span class="p">,</span><span class="n">wd</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"lr:"</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span><span class="s2">"wd:"</span><span class="p">,</span><span class="n">wd</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lr: 0.001 wd: 1.0 - tensor([0.9990])
lr: 0.001 wd: 1.0 - tensor([0.2000])
lr: 0.01 wd: 1.0 - tensor([0.9900])
lr: 0.01 wd: 1.0 - tensor([0.2000])
lr: 0.1 wd: 1.0 - tensor([0.9000])
lr: 0.1 wd: 1.0 - tensor([0.2000])
lr: 1.0 wd: 1.0 - tensor([0.])
lr: 1.0 wd: 1.0 - tensor([0.2000])
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_val</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[tensor([0.9990]), tensor([0.9900]), tensor([0.9000]), tensor([0.])]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pg_val</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[tensor([0.2000]), tensor([0.2000]), tensor([0.2000]), tensor([0.2000])]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Weight_Decay-param-viewing">
<a class="anchor" href="#Weight_Decay-param-viewing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Weight_Decay param viewing<a class="anchor-link" href="#Weight_Decay-param-viewing"> </a>
</h5>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pg_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">lr_list</span><span class="p">,</span><span class="n">wd_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">learning_rate_grid</span><span class="p">,</span> <span class="n">weight_decay_grid</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">lr</span><span class="p">,</span><span class="n">wd</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lr_list</span><span class="p">,</span> <span class="n">wd_list</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">tst_param</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="n">weight_decay</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">wd</span><span class="p">)</span>
        <span class="n">p_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">pg_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"param| "</span><span class="p">,</span><span class="s2">"lr:"</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span><span class="s2">"wd:"</span><span class="p">,</span><span class="n">wd</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"grad | "</span><span class="p">,</span><span class="s2">"lr:"</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span><span class="s2">"wd:"</span><span class="p">,</span><span class="n">wd</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>param|  lr: 0.001 wd: 0.001 - tensor([1.0000])
grad |  lr: 0.001 wd: 0.001 - tensor([0.2000])
param|  lr: 0.01 wd: 0.001 - tensor([1.0000])
grad |  lr: 0.01 wd: 0.001 - tensor([0.2000])
param|  lr: 0.1 wd: 0.001 - tensor([0.9999])
grad |  lr: 0.1 wd: 0.001 - tensor([0.2000])
param|  lr: 1.0 wd: 0.001 - tensor([0.9990])
grad |  lr: 1.0 wd: 0.001 - tensor([0.2000])
param|  lr: 0.001 wd: 0.01 - tensor([1.0000])
grad |  lr: 0.001 wd: 0.01 - tensor([0.2000])
param|  lr: 0.01 wd: 0.01 - tensor([0.9999])
grad |  lr: 0.01 wd: 0.01 - tensor([0.2000])
param|  lr: 0.1 wd: 0.01 - tensor([0.9990])
grad |  lr: 0.1 wd: 0.01 - tensor([0.2000])
param|  lr: 1.0 wd: 0.01 - tensor([0.9900])
grad |  lr: 1.0 wd: 0.01 - tensor([0.2000])
param|  lr: 0.001 wd: 0.1 - tensor([0.9999])
grad |  lr: 0.001 wd: 0.1 - tensor([0.2000])
param|  lr: 0.01 wd: 0.1 - tensor([0.9990])
grad |  lr: 0.01 wd: 0.1 - tensor([0.2000])
param|  lr: 0.1 wd: 0.1 - tensor([0.9900])
grad |  lr: 0.1 wd: 0.1 - tensor([0.2000])
param|  lr: 1.0 wd: 0.1 - tensor([0.9000])
grad |  lr: 1.0 wd: 0.1 - tensor([0.2000])
param|  lr: 0.001 wd: 1.0 - tensor([0.9990])
grad |  lr: 0.001 wd: 1.0 - tensor([0.2000])
param|  lr: 0.01 wd: 1.0 - tensor([0.9900])
grad |  lr: 0.01 wd: 1.0 - tensor([0.2000])
param|  lr: 0.1 wd: 1.0 - tensor([0.9000])
grad |  lr: 0.1 wd: 1.0 - tensor([0.2000])
param|  lr: 1.0 wd: 1.0 - tensor([0.])
grad |  lr: 1.0 wd: 1.0 - tensor([0.2000])
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pg_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">lr_list</span><span class="p">,</span><span class="n">wd_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">learning_rate_grid</span><span class="p">,</span> <span class="n">weight_decay_grid</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">lr</span><span class="p">,</span><span class="n">wd</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lr_list</span><span class="p">,</span> <span class="n">wd_list</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">tst_param</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="n">p_before</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">pg_before</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">weight_decay</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">wd</span><span class="p">)</span>
        <span class="n">p_after</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">pg_after</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">p_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">pg_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"param| "</span><span class="p">,</span><span class="s2">"lr:"</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span><span class="s2">"wd:"</span><span class="p">,</span><span class="n">wd</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">,</span> <span class="n">p_before</span><span class="p">,</span> <span class="s1">'-&gt;'</span><span class="p">,</span> <span class="n">p_after</span><span class="p">)</span>
        <span class="c1">#print("grad | ","lr:",lr,"wd:",wd, "-", pg_before, '-&gt;', pg_after)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>param|  lr: 0.001 wd: 0.001 - tensor([1.]) -&gt; tensor([1.0000])
param|  lr: 0.01 wd: 0.001 - tensor([1.]) -&gt; tensor([1.0000])
param|  lr: 0.1 wd: 0.001 - tensor([1.]) -&gt; tensor([0.9999])
param|  lr: 1.0 wd: 0.001 - tensor([1.]) -&gt; tensor([0.9990])
param|  lr: 0.001 wd: 0.01 - tensor([1.]) -&gt; tensor([1.0000])
param|  lr: 0.01 wd: 0.01 - tensor([1.]) -&gt; tensor([0.9999])
param|  lr: 0.1 wd: 0.01 - tensor([1.]) -&gt; tensor([0.9990])
param|  lr: 1.0 wd: 0.01 - tensor([1.]) -&gt; tensor([0.9900])
param|  lr: 0.001 wd: 0.1 - tensor([1.]) -&gt; tensor([0.9999])
param|  lr: 0.01 wd: 0.1 - tensor([1.]) -&gt; tensor([0.9990])
param|  lr: 0.1 wd: 0.1 - tensor([1.]) -&gt; tensor([0.9900])
param|  lr: 1.0 wd: 0.1 - tensor([1.]) -&gt; tensor([0.9000])
param|  lr: 0.001 wd: 1.0 - tensor([1.]) -&gt; tensor([0.9990])
param|  lr: 0.01 wd: 1.0 - tensor([1.]) -&gt; tensor([0.9900])
param|  lr: 0.1 wd: 1.0 - tensor([1.]) -&gt; tensor([0.9000])
param|  lr: 1.0 wd: 1.0 - tensor([1.]) -&gt; tensor([0.])
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#param updates for weight_decay</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_val</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#gradient doesn't update for weight_decay</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pg_val</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>weight_decay<span class="o">??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_val</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[tensor([1.0000]),
 tensor([1.0000]),
 tensor([0.9999]),
 tensor([0.9990]),
 tensor([1.0000]),
 tensor([0.9999]),
 tensor([0.9990]),
 tensor([0.9900]),
 tensor([0.9999]),
 tensor([0.9990]),
 tensor([0.9900]),
 tensor([0.9000]),
 tensor([0.9990]),
 tensor([0.9900]),
 tensor([0.9000]),
 tensor([0.])]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pg_val</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000]),
 tensor([0.2000])]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Key Takeaways</p>
<ul>
<li>The gradient doesn't change when doing weight decay</li>
<li>LR and WD are tied to each other lr*wd</li>
</ul>
<p>May be worth investigating adaptive learning rates with weight decay.  May end up with more weight decay than intended.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's repeat that process for l2_reg</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l2_reg</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>l2_reg<span class="o">??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>l2_reg takes in lr as a parameter, but it doesn't actually do anything with it.  So my guess is that it only has it as a parameter to keep it consistent with weight decay.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pg_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">lr_list</span><span class="p">,</span><span class="n">wd_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">learning_rate_grid</span><span class="p">,</span> <span class="n">weight_decay_grid</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">lr</span><span class="p">,</span><span class="n">wd</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lr_list</span><span class="p">,</span> <span class="n">wd_list</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">tst_param</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="n">l2_reg</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">wd</span><span class="p">)</span>
        <span class="n">p_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">pg_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"lr:"</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span><span class="s2">"wd:"</span><span class="p">,</span><span class="n">wd</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"lr:"</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span><span class="s2">"wd:"</span><span class="p">,</span><span class="n">wd</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lr: 0.001 wd: 0.001 - tensor([1.])
lr: 0.001 wd: 0.001 - tensor([0.2010])
lr: 0.01 wd: 0.001 - tensor([1.])
lr: 0.01 wd: 0.001 - tensor([0.2010])
lr: 0.1 wd: 0.001 - tensor([1.])
lr: 0.1 wd: 0.001 - tensor([0.2010])
lr: 1.0 wd: 0.001 - tensor([1.])
lr: 1.0 wd: 0.001 - tensor([0.2010])
lr: 0.001 wd: 0.01 - tensor([1.])
lr: 0.001 wd: 0.01 - tensor([0.2100])
lr: 0.01 wd: 0.01 - tensor([1.])
lr: 0.01 wd: 0.01 - tensor([0.2100])
lr: 0.1 wd: 0.01 - tensor([1.])
lr: 0.1 wd: 0.01 - tensor([0.2100])
lr: 1.0 wd: 0.01 - tensor([1.])
lr: 1.0 wd: 0.01 - tensor([0.2100])
lr: 0.001 wd: 0.1 - tensor([1.])
lr: 0.001 wd: 0.1 - tensor([0.3000])
lr: 0.01 wd: 0.1 - tensor([1.])
lr: 0.01 wd: 0.1 - tensor([0.3000])
lr: 0.1 wd: 0.1 - tensor([1.])
lr: 0.1 wd: 0.1 - tensor([0.3000])
lr: 1.0 wd: 0.1 - tensor([1.])
lr: 1.0 wd: 0.1 - tensor([0.3000])
lr: 0.001 wd: 1.0 - tensor([1.])
lr: 0.001 wd: 1.0 - tensor([1.2000])
lr: 0.01 wd: 1.0 - tensor([1.])
lr: 0.01 wd: 1.0 - tensor([1.2000])
lr: 0.1 wd: 1.0 - tensor([1.])
lr: 0.1 wd: 1.0 - tensor([1.2000])
lr: 1.0 wd: 1.0 - tensor([1.])
lr: 1.0 wd: 1.0 - tensor([1.2000])
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_val</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pg_val</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Key Takeaways l2_reg</p>
<ul>
<li>The gradient is updated using wd*param (higher param values would have a higher weight decay penalty</li>
<li>param values remain unchanged when using l2_reg</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If I'm understanding the difference between l2_reg and weight_decay, l2_reg directly modifies the param gradient's by using a hyper parameter <code>wd</code> and the param values themselves.</p>
<p>Whereas weight decay also has a <code>wd</code> parameter, but it uses that parameter alongside the <code>lr</code> to create a dampener on the weights.  So the higher the learning rate, the more weight_decay will dampen the params and same with wd.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Further-Reading">
<a class="anchor" href="#Further-Reading" aria-hidden="true"><span class="octicon octicon-link"></span></a>Further Reading<a class="anchor-link" href="#Further-Reading"> </a>
</h5>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here are a few links to explore from members of the fastai community:</p>
<ul>
<li>
<a href="https://blog.janestreet.com/l2-regularization-and-batch-norm/">https://blog.janestreet.com/l2-regularization-and-batch-norm/</a> (ChrisK)  </li>
<li>
<a href="https://arxiv.org/abs/1711.05101">https://arxiv.org/abs/1711.05101</a> (ilovescience)</li>
<li>
<a href="https://en.wikipedia.org/wiki/Tikhonov_regularization">https://en.wikipedia.org/wiki/Tikhonov_regularization</a> (ilovescience)</li>
</ul>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="kevinbird15/Blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/no%20second%20turkey/2020/09/05/Decouple_WD_Parameter_Deep_Dive.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>This blog is to explore different technical concepts that interest me.  The goal is to take my readers along for the ride as I learn whatever topic catches my attention</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/kevinbird15" title="kevinbird15"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/kjbird15" title="kjbird15"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
